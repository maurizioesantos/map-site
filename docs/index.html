<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Live Geotab Map</title>
  <!-- Load the Geotab API & Map SDK from the official UNPKG CDN -->
  <script src="https://unpkg.com/@geotab/sdk@latest/dist/geotab-api.min.js"></script>
  <script src="https://unpkg.com/@geotab/sdk@latest/dist/geotab-map.min.js"></script>
  <style>
    /* Make the map fill the entire screen */
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
    }
    #map {
      width: 100%;
      height: 100%;
    }
  </style>
</head>
<body>
  <div id="map"></div>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      // 1) Your Geotab server, database, and credentials
      const server      = "https://my.geotab.com";
      const database    = "septixwaste";
      const credentials = {
        userName: "mauriziosantos@septixpr.com",
        password: "Q6uohDcE2DEPHZ3BG8tp"
      };

      // 2) Initialize the Geotab API client
      const api = new GeotabApi({
        url:         server,
        database:    database,
        credentials: credentials,
        useHttps:    true
      });

      // 3) Authenticate, then build the map
      api.authenticate(error => {
        if (error) {
          console.error("Geotab login failed:", error);
          return;
        }

        // Create the map in our #map div
        const map = new Geotab.Map.Map(
          document.getElementById("map"),
          {
            api: api,
            options: {
              zoom:   10,                          // starting zoom
              center: { lat: 18.2208, lng: -66.5901 } // center on Puerto Rico
            }
          }
        );

        // 4) Add your vehicles layer, with auto-refresh every 60 seconds
        map.addDeviceLayer({
          autoRefresh:     true,
          refreshInterval: 60
        });
      });
    });
  </script>
</body>
</html>
